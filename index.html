<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriSimple - Pelacak Kalori & Nutrisi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="img/NutriSimple.png">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8f7f5;
        }
        .section { display: none; }
        .section.active { display: block; }
        .chart-container { position: relative; width: 100%; max-width: 300px; margin-left: auto; margin-right: auto; height: 300px; }
    </style>
</head>
<body class="text-stone-800">

    <div id="app" class="min-h-screen flex flex-col">
        
        <header class="bg-white/80 backdrop-blur-lg shadow-sm sticky top-0 z-50">
            <nav class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 font-bold text-xl text-teal-600">
                            NutriSimple
                        </div>
                        <div class="hidden md:block">
                            <div class="ml-10 flex items-baseline space-x-4">
                                <a href="#beranda" class="nav-link text-stone-600 hover:bg-teal-50 hover:text-teal-600 px-3 py-2 rounded-md text-sm font-medium">Beranda</a>
                                <a href="#kalkulator" class="nav-link text-stone-600 hover:bg-teal-50 hover:text-teal-600 px-3 py-2 rounded-md text-sm font-medium">Kalkulator</a>
                                <a href="#dashboard" class="nav-link text-stone-600 hover:bg-teal-50 hover:text-teal-600 px-3 py-2 rounded-md text-sm font-medium">Dashboard</a>
                            </div>
                        </div>
                    </div>
                    <div class="-mr-2 flex md:hidden">
                        <button id="mobile-menu-button" type="button" class="bg-stone-100 inline-flex items-center justify-center p-2 rounded-md text-stone-500 hover:text-teal-600 hover:bg-stone-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-stone-100 focus:ring-teal-500">
                            <span class="sr-only">Buka menu</span>
                            <svg class="block h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                            </svg>
                            <svg class="hidden h-6 w-6" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                            </svg>
                        </button>
                    </div>
                </div>
            </nav>
            <div class="hidden md:hidden" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="#beranda" class="nav-link-mobile text-stone-600 hover:bg-teal-50 hover:text-teal-600 block px-3 py-2 rounded-md text-base font-medium">Beranda</a>
                    <a href="#kalkulator" class="nav-link-mobile text-stone-600 hover:bg-teal-50 hover:text-teal-600 block px-3 py-2 rounded-md text-base font-medium">Kalkulator</a>
                    <a href="#dashboard" class="nav-link-mobile text-stone-600 hover:bg-teal-50 hover:text-teal-600 block px-3 py-2 rounded-md text-base font-medium">Dashboard</a>
                </div>
            </div>
        </header>

        <main class="flex-grow">
            
            <!-- BERANDA SECTION -->
            <section id="beranda" class="section">
                <div class="max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
                    <div class="text-center">
                        <h1 class="text-4xl tracking-tight font-extrabold text-stone-900 sm:text-5xl md:text-6xl">
                            <span class="block">Pahami Nutrisimu,</span>
                            <span class="block text-teal-600">Mulai Hari Ini.</span>
                        </h1>
                        <p class="mt-3 max-w-md mx-auto text-base text-stone-500 sm:text-lg md:mt-5 md:text-xl md:max-w-3xl">
                            Lacak kalori dan makro dengan mudah. Dapatkan pemahaman sederhana tentang apa yang kamu makan untuk mencapai target kesehatanmu.
                        </p>
                        <div class="mt-5 max-w-md mx-auto sm:flex sm:justify-center md:mt-8">
                            <div class="rounded-md shadow">
                                <a href="#kalkulator" class="nav-link w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-white bg-teal-600 hover:bg-teal-700 md:py-4 md:text-lg md:px-10">
                                    Coba Kalkulator Gratis
                                </a>
                            </div>
                        </div>
                        <p class="mt-3 text-sm text-stone-500">Gratis, cepat, dan tanpa komitmen.</p>
                    </div>

                    <div class="mt-20">
                        <div class="text-center mb-12">
                             <h2 class="text-3xl font-bold text-stone-900">Tiga Langkah Mudah Menuju Sehat</h2>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-12 text-center">
                            <div class="p-6 bg-white rounded-lg shadow-md">
                                <div class="flex items-center justify-center h-12 w-12 rounded-full bg-teal-100 text-teal-600 mx-auto text-2xl font-bold">1</div>
                                <h3 class="mt-5 text-lg font-medium text-stone-900">Hitung Kebutuhanmu</h3>
                                <p class="mt-2 text-base text-stone-500">Gunakan kalkulator kami untuk mengetahui kebutuhan kalori harian (TDEE) dan Indeks Massa Tubuh (IMT/BMI) kamu secara instan.</p>
                            </div>
                            <div class="p-6 bg-white rounded-lg shadow-md">
                                <div class="flex items-center justify-center h-12 w-12 rounded-full bg-teal-100 text-teal-600 mx-auto text-2xl font-bold">2</div>
                                <h3 class="mt-5 text-lg font-medium text-stone-900">Cari & Catat Makanan</h3>
                                <p class="mt-2 text-base text-stone-500">Temukan informasi kalori dan nutrisi dari makanan lokal. Catat apa yang kamu makan setiap hari dengan satu klik.</p>
                            </div>
                            <div class="p-6 bg-white rounded-lg shadow-md">
                                <div class="flex items-center justify-center h-12 w-12 rounded-full bg-teal-100 text-teal-600 mx-auto text-2xl font-bold">3</div>
                                <h3 class="mt-5 text-lg font-medium text-stone-900">Lihat Progresmu</h3>
                                <p class="mt-2 text-base text-stone-500">Pantau total kalori harian di dashboard pribadimu. Simpan riwayat untuk melihat kemajuan dari waktu ke waktu.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- KALKULATOR SECTION -->
            <section id="kalkulator" class="section">
                 <div class="max-w-4xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
                     <div class="text-center">
                        <h2 class="text-3xl font-extrabold text-stone-900 sm:text-4xl">Kalkulator Kebutuhan Kalori & BMI</h2>
                        <p class="mt-4 text-lg text-stone-500">Cari tahu berapa kalori yang kamu butuhkan setiap hari untuk menjaga, menurunkan, atau menaikkan berat badan.</p>
                    </div>
                    <div class="mt-12 bg-white p-8 rounded-xl shadow-lg">
                        <form id="calculator-form" class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-stone-700">Jenis Kelamin</label>
                                <div class="mt-1 flex space-x-4">
                                    <label class="flex items-center">
                                        <input type="radio" name="gender" value="male" class="form-radio h-4 w-4 text-teal-600 border-stone-300 focus:ring-teal-500" checked>
                                        <span class="ml-2 text-stone-700">Pria</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="gender" value="female" class="form-radio h-4 w-4 text-teal-600 border-stone-300 focus:ring-teal-500">
                                        <span class="ml-2 text-stone-700">Wanita</span>
                                    </label>
                                </div>
                            </div>
                            <div class="md:col-span-2 grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div>
                                    <label for="age" class="block text-sm font-medium text-stone-700">Umur (tahun)</label>
                                    <input type="number" name="age" id="age" value="28" class="mt-1 block w-full rounded-md border-stone-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm" required>
                                </div>
                                <div>
                                    <label for="weight" class="block text-sm font-medium text-stone-700">Berat Badan (kg)</label>
                                    <input type="number" name="weight" id="weight" value="65" class="mt-1 block w-full rounded-md border-stone-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm" required>
                                </div>
                                <div>
                                    <label for="height" class="block text-sm font-medium text-stone-700">Tinggi Badan (cm)</label>
                                    <input type="number" name="height" id="height" value="170" class="mt-1 block w-full rounded-md border-stone-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm" required>
                                </div>
                            </div>
                            <div class="md:col-span-2">
                                <label for="activity" class="block text-sm font-medium text-stone-700">Tingkat Aktivitas Harian</label>
                                <select id="activity" name="activity" class="mt-1 block w-full rounded-md border-stone-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm" required>
                                    <option value="1.2">Jarang (Pekerja kantoran, tidak olahraga)</option>
                                    <option value="1.375">Ringan (Olahraga 1-3 kali/minggu)</option>
                                    <option value="1.55" selected>Sedang (Olahraga 3-5 kali/minggu)</option>
                                    <option value="1.725">Aktif (Olahraga 6-7 kali/minggu)</option>
                                    <option value="1.9">Sangat Aktif (Pekerjaan fisik berat/atlet)</option>
                                </select>
                            </div>
                            <div class="md:col-span-2">
                                <label class="block text-sm font-medium text-stone-700">Tujuan</label>
                                <div class="mt-1 flex flex-wrap gap-4">
                                    <label class="flex items-center">
                                        <input type="radio" name="goal" value="maintain" class="form-radio h-4 w-4 text-teal-600 border-stone-300 focus:ring-teal-500" checked>
                                        <span class="ml-2 text-stone-700">Menjaga berat badan</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="goal" value="lose" class="form-radio h-4 w-4 text-teal-600 border-stone-300 focus:ring-teal-500">
                                        <span class="ml-2 text-stone-700">Menurunkan berat badan</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="radio" name="goal" value="gain" class="form-radio h-4 w-4 text-teal-600 border-stone-300 focus:ring-teal-500">
                                        <span class="ml-2 text-stone-700">Menaikkan berat badan</span>
                                    </label>
                                </div>
                            </div>
                            <div class="md:col-span-2 text-center">
                                <button type="submit" class="w-full md:w-auto inline-flex justify-center rounded-md border border-transparent bg-teal-600 py-3 px-12 text-base font-medium text-white shadow-sm hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2 transition-transform transform hover:scale-105">
                                    üöÄ Hitung Kebutuhan Saya
                                </button>
                            </div>
                        </form>
                    </div>

                    <!-- Results Section -->
                    <div id="calculator-results" class="mt-12 hidden">
                        <div class="bg-white rounded-xl shadow-lg p-8">
                            <h3 class="text-2xl font-bold text-center text-stone-900">Hasil Perhitungan Anda</h3>
                            <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-8 text-center">
                                <div class="bg-stone-50 p-6 rounded-lg">
                                    <h4 class="text-sm font-medium text-stone-500 uppercase tracking-wider">Indeks Massa Tubuh (BMI)</h4>
                                    <p id="bmi-result" class="mt-1 text-4xl font-extrabold text-teal-600"></p>
                                    <p id="bmi-status" class="mt-1 text-lg font-medium text-stone-700"></p>
                                    <p class="mt-2 text-xs text-stone-400">Disclaimer: BMI adalah indikator awal.</p>
                                </div>
                                <div class="bg-stone-50 p-6 rounded-lg">
                                    <h4 class="text-sm font-medium text-stone-500 uppercase tracking-wider">Target Kalori Berdasarkan Tujuan</h4>
                                    <p class="mt-1 text-4xl font-extrabold text-teal-600"><span id="target-calories"></span> <span class="text-2xl font-medium text-stone-600">kkal/hari</span></p>
                                    <p id="goal-description" class="mt-1 text-sm text-stone-600"></p>
                                </div>
                            </div>
                            <div class="mt-8">
                                <h4 class="text-lg font-medium text-center text-stone-800">Rekomendasi Berdasarkan TDEE</h4>
                                <div class="mt-4 grid grid-cols-1 md:grid-cols-3 gap-4">
                                     <div class="border border-stone-200 rounded-lg p-4 text-center">
                                        <p class="font-medium text-stone-700">Menjaga Berat Badan</p>
                                        <p class="text-xl font-bold text-green-600 mt-1" id="tdee-maintain"></p>
                                    </div>
                                     <div class="border border-stone-200 rounded-lg p-4 text-center">
                                        <p class="font-medium text-stone-700">Menurunkan (Defisit Ringan)</p>
                                        <p class="text-xl font-bold text-blue-600 mt-1" id="tdee-loss"></p>
                                    </div>
                                    <div class="border border-stone-200 rounded-lg p-4 text-center">
                                        <p class="font-medium text-stone-700">Menaikkan (Surplus Ringan)</p>
                                        <p class="text-xl font-bold text-orange-500 mt-1" id="tdee-gain"></p>
                                    </div>
                                </div>
                            </div>
                             <div class="mt-8 text-center">
                                <button id="save-profile-btn" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-teal-600 hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-teal-500 transition-all duration-200">
                                    üíæ Simpan Profil & Gunakan di Dashboard
                                </button>
                                <p class="mt-2 text-sm text-stone-500">Data akan tersimpan selama session browser ini aktif</p>
                            </div>
                        </div>
                    </div>
                 </div>
            </section>
            
            <!-- DASHBOARD SECTION -->
            <section id="dashboard" class="section">
                <div class="max-w-7xl mx-auto py-16 px-4 sm:px-6 lg:px-8">
                    <div class="text-center">
                        <h2 class="text-3xl font-extrabold text-stone-900 sm:text-4xl">Dashboard Hari Ini</h2>
                        <p id="current-date" class="mt-2 text-lg text-stone-500"></p>
                    </div>

                    <!-- Warning for no profile -->
                    <div id="no-profile-warning" class="mt-8 bg-amber-50 border border-amber-200 rounded-lg p-6 text-center">
                        <div class="flex items-center justify-center w-12 h-12 mx-auto bg-amber-100 rounded-full">
                            <svg class="w-6 h-6 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.96-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                            </svg>
                        </div>
                        <h3 class="mt-4 text-lg font-medium text-amber-800">Belum Ada Profil Nutrisi</h3>
                        <p class="mt-2 text-amber-700">Silakan hitung kebutuhan kalori Anda terlebih dahulu di halaman Kalkulator untuk mendapatkan rekomendasi yang akurat.</p>
                        <a href="#kalkulator" class="nav-link mt-4 inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-amber-600 hover:bg-amber-700">
                            Hitung Kebutuhan Kalori ‚Üí
                        </a>
                    </div>

                    <!-- Main Dashboard Content -->
                    <div id="dashboard-content" class="mt-12 grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <div class="lg:col-span-2">
                            <div class="bg-white p-6 rounded-xl shadow-lg">
                                <h3 class="text-lg font-medium text-stone-900">Pencatat Makanan</h3>
                                <form id="food-form" class="mt-4 space-y-3">
                                    <div class="grid grid-cols-1 sm:grid-cols-2 gap-3">
                                        <div>
                                            <label class="block text-sm font-medium text-stone-700 mb-1">Pilih Makanan</label>
                                            <select id="food-select" class="w-full rounded-md border-stone-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm" required>
                                                <option value="">-- Pilih Makanan --</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-stone-700 mb-1">Berat (gram)</label>
                                            <input type="number" id="food-weight" placeholder="100" min="1" class="w-full rounded-md border-stone-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm" required>
                                        </div>
                                    </div>
                                    
                                    <!-- Nutrition Info Preview -->
                                    <div id="nutrition-preview" class="hidden bg-teal-50 p-3 rounded-lg">
                                        <h4 class="text-sm font-medium text-teal-800 mb-2">Informasi Nutrisi (per <span id="preview-weight">100</span>g):</h4>
                                        <div class="grid grid-cols-2 sm:grid-cols-4 gap-2 text-sm">
                                            <div class="text-center">
                                                <p class="font-semibold text-teal-600" id="preview-calories">0</p>
                                                <p class="text-teal-700">Kalori</p>
                                            </div>
                                            <div class="text-center">
                                                <p class="font-semibold text-blue-600" id="preview-protein">0g</p>
                                                <p class="text-blue-700">Protein</p>
                                            </div>
                                            <div class="text-center">
                                                <p class="font-semibold text-orange-600" id="preview-carbs">0g</p>
                                                <p class="text-orange-700">Karbo</p>
                                            </div>
                                            <div class="text-center">
                                                <p class="font-semibold text-red-600" id="preview-fat">0g</p>
                                                <p class="text-red-700">Lemak</p>
                                            </div>
                                        </div>
                                        <p class="text-xs text-teal-600 mt-2" id="data-source">Sumber: -</p>
                                    </div>
                                    
                                    <button type="submit" class="w-full inline-flex justify-center rounded-md border border-transparent bg-teal-600 py-2 px-4 text-sm font-medium text-white shadow-sm hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2">
                                        + Tambah ke Diary
                                    </button>
                                </form>
                                <div class="mt-6">
                                    <h4 class="text-md font-medium text-stone-800">Diary Makanan Hari Ini</h4>
                                    <ul id="food-list" class="mt-2 space-y-2"></ul>
                                    <p id="empty-log-message" class="text-sm text-stone-400 mt-4 text-center">Belum ada makanan yang dicatat hari ini.</p>
                                </div>
                            </div>
                        </div>
                        
                        <div class="space-y-8">
                             <div class="bg-white p-6 rounded-xl shadow-lg text-center">
                                <h3 class="text-lg font-medium text-stone-900">Ringkasan Kalori Harian</h3>
                                <div class="chart-container my-4">
                                    <canvas id="calorie-chart"></canvas>
                                </div>
                                <div class="text-4xl font-bold text-stone-800">
                                    <span id="calories-consumed">0</span> / <span id="calories-total">2000</span>
                                </div>
                                <p class="text-stone-500">kkal</p>
                                <div id="calorie-status" class="mt-2 text-sm"></div>
                                
                                <!-- Makronutrien Summary -->
                                <div class="mt-6 pt-4 border-t border-stone-200">
                                    <h4 class="text-sm font-medium text-stone-700 mb-3">Makronutrien Hari Ini</h4>
                                    <div class="grid grid-cols-3 gap-3 text-xs">
                                        <div class="bg-blue-50 p-2 rounded">
                                            <p class="font-semibold text-blue-600" id="total-protein">0g</p>
                                            <p class="text-blue-700">Protein</p>
                                        </div>
                                        <div class="bg-orange-50 p-2 rounded">
                                            <p class="font-semibold text-orange-600" id="total-carbs">0g</p>
                                            <p class="text-orange-700">Karbo</p>
                                        </div>
                                        <div class="bg-red-50 p-2 rounded">
                                            <p class="font-semibold text-red-600" id="total-fat">0g</p>
                                            <p class="text-red-700">Lemak</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="bg-white p-6 rounded-xl shadow-lg">
                                <div class="flex items-center justify-between">
                                    <h3 class="text-lg font-medium text-stone-900">Profil Nutrisimu</h3>
                                    <button id="edit-profile-btn" class="text-teal-600 hover:text-teal-800 text-sm font-medium">‚úè Edit</button>
                                </div>
                                <ul class="mt-4 space-y-2 text-sm text-stone-600">
                                    <li class="flex justify-between"><span>Berat Badan:</span> <span id="profile-weight" class="font-medium text-stone-800">-</span></li>
                                    <li class="flex justify-between"><span>Tinggi Badan:</span> <span id="profile-height" class="font-medium text-stone-800">-</span></li>
                                    <li class="flex justify-between"><span>BMI:</span> <span id="profile-bmi" class="font-medium text-stone-800">-</span></li>
                                    <li class="flex justify-between"><span>Target Kalori:</span> <span id="profile-target" class="font-medium text-stone-800">-</span></li>
                                    <li class="flex justify-between"><span>Tujuan:</span> <span id="profile-goal" class="font-medium text-stone-800">-</span></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Edit Profile Modal -->
            <div id="edit-profile-modal" class="hidden fixed inset-0 bg-black/50 flex items-center justify-center z-50">
                <div class="bg-white p-6 rounded-lg w-80 max-w-md mx-4">
                    <h3 class="text-lg font-bold text-stone-900">Edit Profil Nutrisi</h3>
                    <form id="edit-profile-form" class="mt-4 space-y-3">
                        <div>
                            <label class="block text-sm font-medium text-stone-700">Berat Badan (kg)</label>
                            <input type="number" id="edit-weight" class="mt-1 w-full border border-stone-300 rounded-md px-3 py-2 focus:border-teal-500 focus:ring-teal-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-stone-700">Tinggi Badan (cm)</label>
                            <input type="number" id="edit-height" class="mt-1 w-full border border-stone-300 rounded-md px-3 py-2 focus:border-teal-500 focus:ring-teal-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-stone-700">Target Kalori (kkal/hari)</label>
                            <input type="number" id="edit-calorie" class="mt-1 w-full border border-stone-300 rounded-md px-3 py-2 focus:border-teal-500 focus:ring-teal-500" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-stone-700">Tujuan</label>
                            <select id="edit-goal" class="mt-1 w-full border border-stone-300 rounded-md px-3 py-2 focus:border-teal-500 focus:ring-teal-500">
                                <option value="maintain">Menjaga berat badan</option>
                                <option value="lose">Menurunkan berat badan</option>
                                <option value="gain">Menaikkan berat badan</option>
                            </select>
                        </div>
                        <div class="flex justify-end space-x-2 mt-6">
                            <button type="button" id="close-edit" class="px-4 py-2 bg-stone-200 text-stone-700 rounded-md hover:bg-stone-300">Batal</button>
                            <button type="submit" class="px-4 py-2 bg-teal-600 text-white rounded-md hover:bg-teal-700">Simpan</button>
                        </div>
                    </form>
                </div>
            </div>

        </main>
        
        <!-- FOOTER -->
        <footer class="bg-white border-t border-stone-200">
             <div class="max-w-7xl mx-auto py-6 px-4 sm:px-6 lg:px-8">
                <div class="text-center text-sm text-stone-500 space-y-4">
                    <div class="flex justify-center space-x-6">
                        <a href="#" class="hover:text-teal-600">Tentang</a>
                        <a href="#" class="hover:text-teal-600">Privacy</a>
                        <a href="#" class="hover:text-teal-600">Disclaimer</a>
                        <a href="#" class="hover:text-teal-600">Kontak</a>
                    </div>
                    
                    <!-- Data Sources Disclaimer -->
                    <div class="bg-stone-50 p-4 rounded-lg text-xs text-stone-600">
                        <h4 class="font-medium text-stone-800 mb-2">Sumber Data Nutrisi:</h4>
                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-2">
                            <div>
                                <p class="font-medium">Makanan Indonesia:</p>
                                <p>TKPI 2017 - Tabel Komposisi Pangan Indonesia</p>
                                <p>Kementerian Kesehatan Republik Indonesia</p>
                            </div>
                            <div>
                                <p class="font-medium">Makanan Internasional:</p>
                                <p>USDA FoodData Central</p>
                                <p>U.S. Department of Agriculture</p>
                            </div>
                        </div>
                        <p class="mt-3 text-stone-500">
                            <strong>Disclaimer:</strong> Data nutrisi bersifat estimasi dan dapat bervariasi tergantung metode pengolahan, 
                            varietas bahan, dan faktor lainnya. Konsultasikan dengan ahli gizi untuk kebutuhan diet khusus.
                        </p>
                    </div>
                    
                    <p>&copy; 2025 NutriSimple. All rights reserved.</p>
                </div>
             </div>
        </footer>
    </div>

    <script>
        // Database makanan dengan makronutrien dari TKPI 2017 & USDA FoodData Central
        // Sumber: Kemenkes RI (TKPI 2017) & USDA FoodData Central
        const foodDatabase = {
            // === MAKANAN POKOK - TKPI 2017 ===
            "Nasi Putih": { calories: 129, protein: 2.7, carbs: 28.1, fat: 0.3, category: "Makanan Pokok", source: "TKPI 2017" },
            "Nasi Merah": { calories: 110, protein: 2.5, carbs: 22.9, fat: 0.9, category: "Makanan Pokok", source: "TKPI 2017" },
            "Nasi Goreng": { calories: 228, protein: 4.2, carbs: 31.7, fat: 9.4, category: "Makanan Pokok", source: "TKPI 2017" },
            "Mie Ayam": { calories: 125, protein: 4.9, carbs: 18.6, fat: 3.7, category: "Makanan Pokok", source: "TKPI 2017" },
            "Mie Goreng": { calories: 199, protein: 5.2, carbs: 40.0, fat: 2.7, category: "Makanan Pokok", source: "TKPI 2017" },
            "Roti Tawar Putih": { calories: 248, protein: 8.0, carbs: 50.0, fat: 1.2, category: "Makanan Pokok", source: "TKPI 2017" },
            "Kentang Rebus": { calories: 62, protein: 2.1, carbs: 13.5, fat: 0.1, category: "Makanan Pokok", source: "TKPI 2017" },
            "Jagung Rebus": { calories: 96, protein: 3.5, carbs: 22.8, fat: 1.0, category: "Makanan Pokok", source: "TKPI 2017" },
            
            // === LAUK PAUK - TKPI 2017 ===
            "Ayam Goreng": { calories: 298, protein: 18.2, carbs: 11.5, fat: 20.9, category: "Lauk Pauk", source: "TKPI 2017" },
            "Ayam Bakar": { calories: 164, protein: 25.8, carbs: 0, fat: 6.2, category: "Lauk Pauk", source: "TKPI 2017" },
            "Rendang Daging": { calories: 468, protein: 28.3, carbs: 4.5, fat: 37.0, category: "Lauk Pauk", source: "TKPI 2017" },
            "Ikan Bakar": { calories: 140, protein: 22.0, carbs: 0, fat: 4.5, category: "Lauk Pauk", source: "TKPI 2017" },
            "Ikan Goreng": { calories: 188, protein: 20.0, carbs: 2.0, fat: 10.3, category: "Lauk Pauk", source: "TKPI 2017" },
            "Telur Ayam Rebus": { calories: 154, protein: 12.4, carbs: 0.7, fat: 10.8, category: "Lauk Pauk", source: "TKPI 2017" },
            "Telur Dadar": { calories: 199, protein: 10.8, carbs: 1.5, fat: 17.0, category: "Lauk Pauk", source: "TKPI 2017" },
            "Tahu Goreng": { calories: 134, protein: 10.6, carbs: 4.9, fat: 8.1, category: "Lauk Pauk", source: "TKPI 2017" },
            "Tempe Goreng": { calories: 192, protein: 14.0, carbs: 11.5, fat: 10.8, category: "Lauk Pauk", source: "TKPI 2017" },
            "Sate Ayam (5 tusuk)": { calories: 210, protein: 14.1, carbs: 3.0, fat: 15.5, category: "Lauk Pauk", source: "TKPI 2017" },
            
            // === SAYURAN - TKPI 2017 ===
            "Gado-gado": { calories: 136, protein: 4.0, carbs: 9.4, fat: 9.0, category: "Sayuran", source: "TKPI 2017" },
            "Sayur Asem": { calories: 31, protein: 1.5, carbs: 7.2, fat: 0.2, category: "Sayuran", source: "TKPI 2017" },
            "Cap Cay": { calories: 58, protein: 2.8, carbs: 8.8, fat: 1.7, category: "Sayuran", source: "TKPI 2017" },
            "Tumis Kangkung": { calories: 36, protein: 3.0, carbs: 6.2, fat: 0.7, category: "Sayuran", source: "TKPI 2017" },
            "Sayur Sop": { calories: 18, protein: 1.2, carbs: 3.8, fat: 0.2, category: "Sayuran", source: "TKPI 2017" },
            "Bayam Rebus": { calories: 36, protein: 3.5, carbs: 6.5, fat: 0.5, category: "Sayuran", source: "TKPI 2017" },
            "Buncis Rebus": { calories: 35, protein: 2.4, carbs: 7.1, fat: 0.2, category: "Sayuran", source: "TKPI 2017" },
            
            // === BUAH-BUAHAN - TKPI 2017 ===
            "Pisang Ambon": { calories: 99, protein: 1.2, carbs: 25.8, fat: 0.2, category: "Buah", source: "TKPI 2017" },
            "Pisang Raja": { calories: 118, protein: 1.0, carbs: 31.8, fat: 0.2, category: "Buah", source: "TKPI 2017" },
            "Jeruk Manis": { calories: 45, protein: 0.9, carbs: 11.2, fat: 0.2, category: "Buah", source: "TKPI 2017" },
            "Mangga Golek": { calories: 46, protein: 0.6, carbs: 12.1, fat: 0.1, category: "Buah", source: "TKPI 2017" },
            "Pepaya": { calories: 46, protein: 0.5, carbs: 12.2, fat: 0.1, category: "Buah", source: "TKPI 2017" },
            "Semangka": { calories: 28, protein: 0.5, carbs: 6.9, fat: 0.2, category: "Buah", source: "TKPI 2017" },
            "Apel Malang": { calories: 58, protein: 0.3, carbs: 14.9, fat: 0.4, category: "Buah", source: "TKPI 2017" },
            "Rambutan": { calories: 69, protein: 1.0, carbs: 16.5, fat: 0.3, category: "Buah", source: "TKPI 2017" },
            
            // === MAKANAN INTERNASIONAL - USDA FoodData Central ===
            "Pizza Margherita": { calories: 266, protein: 11.4, carbs: 33.0, fat: 10.4, category: "Internasional", source: "USDA FDC" },
            "Burger Beef": { calories: 295, protein: 17.0, carbs: 24.0, fat: 16.0, category: "Internasional", source: "USDA FDC" },
            "Pasta Bolognese": { calories: 135, protein: 6.8, carbs: 18.0, fat: 4.4, category: "Internasional", source: "USDA FDC" },
            "Chicken Steak": { calories: 231, protein: 24.0, carbs: 0, fat: 14.8, category: "Internasional", source: "USDA FDC" },
            "Sandwich Club": { calories: 282, protein: 15.8, carbs: 26.2, fat: 13.4, category: "Internasional", source: "USDA FDC" },
            "Caesar Salad": { calories: 56, protein: 3.0, carbs: 3.0, fat: 4.5, category: "Internasional", source: "USDA FDC" },
            "Fried Rice": { calories: 163, protein: 4.2, carbs: 20.0, fat: 7.5, category: "Internasional", source: "USDA FDC" },
            "French Fries": { calories: 365, protein: 4.0, carbs: 63.0, fat: 17.0, category: "Internasional", source: "USDA FDC" },
            
            // === MINUMAN - TKPI 2017 & USDA ===
            "Es Teh Manis": { calories: 41, protein: 0, carbs: 10.7, fat: 0, category: "Minuman", source: "TKPI 2017" },
            "Kopi Hitam": { calories: 9, protein: 0.1, carbs: 1.8, fat: 0.2, category: "Minuman", source: "TKPI 2017" },
            "Kopi Susu": { calories: 74, protein: 2.2, carbs: 8.0, fat: 3.7, category: "Minuman", source: "TKPI 2017" },
            "Jus Jeruk": { calories: 51, protein: 0.5, carbs: 13.4, fat: 0.1, category: "Minuman", source: "TKPI 2017" },
            "Susu Sapi": { calories: 61, protein: 3.0, carbs: 4.3, fat: 3.5, category: "Minuman", source: "TKPI 2017" },
            "Air Mineral": { calories: 0, protein: 0, carbs: 0, fat: 0, category: "Minuman", source: "USDA FDC" },
            "Coca Cola": { calories: 42, protein: 0, carbs: 10.6, fat: 0, category: "Minuman", source: "USDA FDC" },
            
            // === SNACK & DESSERT - TKPI 2017 & USDA ===
            "Keripik Singkong": { calories: 526, protein: 2.5, carbs: 61.1, fat: 29.4, category: "Snack", source: "TKPI 2017" },
            "Biskuit Marie": { calories: 458, protein: 6.8, carbs: 71.5, fat: 16.4, category: "Snack", source: "TKPI 2017" },
            "Es Krim Vanilla": { calories: 207, protein: 3.5, carbs: 23.6, fat: 11.0, category: "Snack", source: "USDA FDC" },
            "Cokelat Susu": { calories: 535, protein: 7.9, carbs: 59.4, fat: 29.7, category: "Snack", source: "USDA FDC" },
            "Donat Gula": { calories: 421, protein: 4.6, carbs: 51.0, fat: 22.0, category: "Snack", source: "USDA FDC" },
            "Kue Lapis": { calories: 325, protein: 4.9, carbs: 54.2, fat: 10.4, category: "Snack", source: "TKPI 2017" },
            "Martabak Manis": { calories: 320, protein: 6.2, carbs: 45.0, fat: 13.5, category: "Snack", source: "TKPI 2017" }
        };

        // Global state untuk menyimpan profil
        let userProfile = {
            weight: null,
            height: null,
            bmi: null,
            targetCalories: null,
            goal: null,
            goalText: null
        };

        document.addEventListener('DOMContentLoaded', () => {
            // Initialize navigation
            const sections = document.querySelectorAll('.section');
            const navLinks = document.querySelectorAll('.nav-link');
            const mobileNavLinks = document.querySelectorAll('.nav-link-mobile');
            const mobileMenuButton = document.getElementById('mobile-menu-button');
            const mobileMenu = document.getElementById('mobile-menu');

            function showSection(id) {
                sections.forEach(section => {
                    if (section.id === id) {
                        section.classList.add('active');
                    } else {
                        section.classList.remove('active');
                    }
                });
                window.scrollTo(0, 0);
                
                // Update dashboard when switching to it
                if (id === 'dashboard') {
                    updateDashboard();
                }
            }

            function navigate(e) {
                e.preventDefault();
                const targetId = e.currentTarget.getAttribute('href').substring(1);
                history.pushState({}, '', `#${targetId}`);
                showSection(targetId);
                updateActiveLink(targetId);
            }

            function updateActiveLink(targetId) {
                [...navLinks, ...mobileNavLinks].forEach(link => {
                    if (link.getAttribute('href') === `#${targetId}`) {
                        link.classList.add('bg-teal-50', 'text-teal-600');
                    } else {
                        link.classList.remove('bg-teal-50', 'text-teal-600');
                    }
                });
            }

            navLinks.forEach(link => link.addEventListener('click', navigate));
            mobileNavLinks.forEach(link => {
                link.addEventListener('click', (e) => {
                    navigate(e);
                    mobileMenu.classList.add('hidden');
                    mobileMenuButton.querySelector('svg.block').classList.remove('hidden');
                    mobileMenuButton.querySelector('svg.hidden').classList.add('hidden');
                });
            });

            mobileMenuButton.addEventListener('click', () => {
                mobileMenu.classList.toggle('hidden');
                mobileMenuButton.querySelector('svg.block').classList.toggle('hidden');
                mobileMenuButton.querySelector('svg.hidden').classList.toggle('hidden');
            });

            window.addEventListener('popstate', () => {
                const hash = window.location.hash.substring(1) || 'beranda';
                showSection(hash);
                updateActiveLink(hash);
            });
            
            const initialHash = window.location.hash.substring(1) || 'beranda';
            showSection(initialHash);
            updateActiveLink(initialHash);

            // Calculator functionality
            const calculatorForm = document.getElementById('calculator-form');
            calculatorForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const formData = new FormData(calculatorForm);
                const gender = formData.get('gender');
                const age = parseFloat(formData.get('age'));
                const weight = parseFloat(formData.get('weight'));
                const height = parseFloat(formData.get('height'));
                const activity = parseFloat(formData.get('activity'));
                const goal = formData.get('goal');

                if (isNaN(age) || isNaN(weight) || isNaN(height) || age <= 0 || weight <= 0 || height <= 0) {
                    alert('Mohon isi semua data dengan angka yang valid.');
                    return;
                }

                // Calculate BMI
                const heightInMeters = height / 100;
                const bmi = weight / (heightInMeters * heightInMeters);
                
                // Calculate BMR using Mifflin-St Jeor equation (more accurate)
                let bmr;
                if (gender === 'male') {
                    bmr = (10 * weight) + (6.25 * height) - (5 * age) + 5;
                } else {
                    bmr = (10 * weight) + (6.25 * height) - (5 * age) - 161;
                }
                
                const tdee = bmr * activity;

                // Calculate target based on goal
                let targetCalories;
                let goalDescription;
                let goalText;
                
                switch(goal) {
                    case 'lose':
                        targetCalories = Math.round(tdee - 300);
                        goalDescription = 'Defisit kalori untuk menurunkan berat badan';
                        goalText = 'Menurunkan berat badan';
                        break;
                    case 'gain':
                        targetCalories = Math.round(tdee + 300);
                        goalDescription = 'Surplus kalori untuk menaikkan berat badan';
                        goalText = 'Menaikkan berat badan';
                        break;
                    default:
                        targetCalories = Math.round(tdee);
                        goalDescription = 'Kalori untuk menjaga berat badan';
                        goalText = 'Menjaga berat badan';
                }

                // Store calculation results
                window.calculationResults = {
                    weight,
                    height,
                    bmi,
                    targetCalories,
                    goal,
                    goalText,
                    tdee: Math.round(tdee)
                };

                // Display results
                document.getElementById('bmi-result').textContent = bmi.toFixed(1);
                let bmiStatusText;
                if (bmi < 18.5) bmiStatusText = 'Berat Badan Kurang';
                else if (bmi < 24.9) bmiStatusText = 'Berat Badan Ideal';
                else if (bmi < 29.9) bmiStatusText = 'Berat Badan Berlebih';
                else bmiStatusText = 'Obesitas';
                document.getElementById('bmi-status').textContent = bmiStatusText;

                document.getElementById('target-calories').textContent = targetCalories;
                document.getElementById('goal-description').textContent = goalDescription;
                
                document.getElementById('tdee-maintain').textContent = `${Math.round(tdee)} kkal/hari`;
                document.getElementById('tdee-loss').textContent = `${Math.round(tdee - 300)} kkal/hari`;
                document.getElementById('tdee-gain').textContent = `${Math.round(tdee + 300)} kkal/hari`;
                
                document.getElementById('calculator-results').classList.remove('hidden');
            });

            // Save profile functionality
            document.getElementById('save-profile-btn').addEventListener('click', () => {
                if (window.calculationResults) {
                    userProfile = { ...window.calculationResults };
                    alert('Profil berhasil disimpan! Silakan cek dashboard Anda.');
                    // Navigate to dashboard
                    history.pushState({}, '', '#dashboard');
                    showSection('dashboard');
                    updateActiveLink('dashboard');
                }
            });

            // Set current date
            const today = new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            document.getElementById('current-date').textContent = today.toLocaleDateString('id-ID', options);

            // Initialize food database dropdown
            function initializeFoodDropdown() {
                const foodSelect = document.getElementById('food-select');
                const categories = {};
                
                // Group foods by category
                Object.keys(foodDatabase).forEach(food => {
                    const category = foodDatabase[food].category;
                    if (!categories[category]) categories[category] = [];
                    categories[category].push(food);
                });
                
                // Populate dropdown with optgroups
                Object.keys(categories).sort().forEach(category => {
                    const optgroup = document.createElement('optgroup');
                    optgroup.label = category;
                    
                    categories[category].sort().forEach(food => {
                        const option = document.createElement('option');
                        option.value = food;
                        option.textContent = food;
                        optgroup.appendChild(option);
                    });
                    
                    foodSelect.appendChild(optgroup);
                });
            }

            // Handle food selection and preview
            document.getElementById('food-select').addEventListener('change', function() {
                const selectedFood = this.value;
                const weightInput = document.getElementById('food-weight');
                const previewDiv = document.getElementById('nutrition-preview');
                
                if (selectedFood && foodDatabase[selectedFood]) {
                    previewDiv.classList.remove('hidden');
                    weightInput.value = weightInput.value || '100';
                    updateNutritionPreview();
                } else {
                    previewDiv.classList.add('hidden');
                }
            });

            // Handle weight change and update preview
            document.getElementById('food-weight').addEventListener('input', function() {
                const selectedFood = document.getElementById('food-select').value;
                if (selectedFood && foodDatabase[selectedFood]) {
                    updateNutritionPreview();
                }
            });

            function updateNutritionPreview() {
                const selectedFood = document.getElementById('food-select').value;
                const weight = parseFloat(document.getElementById('food-weight').value) || 100;
                
                if (selectedFood && foodDatabase[selectedFood]) {
                    const food = foodDatabase[selectedFood];
                    const multiplier = weight / 100;
                    
                    document.getElementById('preview-weight').textContent = weight;
                    document.getElementById('preview-calories').textContent = Math.round(food.calories * multiplier);
                    document.getElementById('preview-protein').textContent = (food.protein * multiplier).toFixed(1) + 'g';
                    document.getElementById('preview-carbs').textContent = (food.carbs * multiplier).toFixed(1) + 'g';
                    document.getElementById('preview-fat').textContent = (food.fat * multiplier).toFixed(1) + 'g';
                }
            }

            function updateNutritionPreview() {
                const selectedFood = document.getElementById('food-select').value;
                const weight = parseFloat(document.getElementById('food-weight').value) || 100;
                
                if (selectedFood && foodDatabase[selectedFood]) {
                    const food = foodDatabase[selectedFood];
                    const multiplier = weight / 100;
                    
                    document.getElementById('preview-weight').textContent = weight;
                    document.getElementById('preview-calories').textContent = Math.round(food.calories * multiplier);
                    document.getElementById('preview-protein').textContent = (food.protein * multiplier).toFixed(1) + 'g';
                    document.getElementById('preview-carbs').textContent = (food.carbs * multiplier).toFixed(1) + 'g';
                    document.getElementById('preview-fat').textContent = (food.fat * multiplier).toFixed(1) + 'g';
                    document.getElementById('data-source').textContent = `Sumber: ${food.source}`;
                }
            }

            // Food log functionality with macronutrients
            let foodLog = [];
            const foodListEl = document.getElementById('food-list');
            const foodForm = document.getElementById('food-form');
            const caloriesConsumedEl = document.getElementById('calories-consumed');
            const caloriesTotalEl = document.getElementById('calories-total');
            const emptyLogMessage = document.getElementById('empty-log-message');

            function renderFoodLog() {
                foodListEl.innerHTML = '';
                if(foodLog.length === 0){
                    emptyLogMessage.style.display = 'block';
                } else {
                    emptyLogMessage.style.display = 'none';
                    foodLog.forEach((food, index) => {
                        const li = document.createElement('li');
                        li.className = 'bg-stone-50 p-3 rounded-md';
                        li.innerHTML = `
                            <div class="flex justify-between items-start">
                                <div class="flex-grow">
                                    <div class="flex justify-between items-center">
                                        <p class="font-medium text-stone-700">${food.name}</p>
                                        <button data-index="${index}" class="remove-food-btn text-stone-400 hover:text-red-500 text-xl ml-2">&times;</button>
                                    </div>
                                    <p class="text-sm text-stone-500">${food.weight}g ‚Ä¢ ${food.calories} kkal</p>
                                    <div class="flex space-x-3 mt-1 text-xs">
                                        <span class="text-blue-600">P: ${food.protein}g</span>
                                        <span class="text-orange-600">K: ${food.carbs}g</span>
                                        <span class="text-red-600">L: ${food.fat}g</span>
                                    </div>
                                </div>
                            </div>
                        `;
                        foodListEl.appendChild(li);
                    });
                }
                updateCalorieChart();
                updateMacronutrientSummary();
            }

            function updateMacronutrientSummary() {
                const totals = foodLog.reduce((sum, food) => ({
                    protein: sum.protein + food.protein,
                    carbs: sum.carbs + food.carbs,
                    fat: sum.fat + food.fat
                }), { protein: 0, carbs: 0, fat: 0 });

                document.getElementById('total-protein').textContent = totals.protein.toFixed(1) + 'g';
                document.getElementById('total-carbs').textContent = totals.carbs.toFixed(1) + 'g';
                document.getElementById('total-fat').textContent = totals.fat.toFixed(1) + 'g';
            }
            
            foodForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const selectedFood = document.getElementById('food-select').value;
                const weight = parseFloat(document.getElementById('food-weight').value);
                
                if (selectedFood && weight > 0 && foodDatabase[selectedFood]) {
                    const food = foodDatabase[selectedFood];
                    const multiplier = weight / 100;
                    
                    const foodEntry = {
                        name: selectedFood,
                        weight: weight,
                        calories: Math.round(food.calories * multiplier),
                        protein: parseFloat((food.protein * multiplier).toFixed(1)),
                        carbs: parseFloat((food.carbs * multiplier).toFixed(1)),
                        fat: parseFloat((food.fat * multiplier).toFixed(1))
                    };
                    
                    foodLog.push(foodEntry);
                    renderFoodLog();
                    
                    // Reset form
                    document.getElementById('food-select').value = '';
                    document.getElementById('food-weight').value = '';
                    document.getElementById('nutrition-preview').classList.add('hidden');
                } else {
                    alert('Mohon pilih makanan dan masukkan berat yang valid.');
                }
            });
            
            foodListEl.addEventListener('click', (e) => {
                if(e.target.classList.contains('remove-food-btn')) {
                    const index = parseInt(e.target.dataset.index, 10);
                    foodLog.splice(index, 1);
                    renderFoodLog();
                }
            });

            // Initialize chart
            const ctx = document.getElementById('calorie-chart').getContext('2d');
            let calorieChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Terkonsumsi', 'Sisa'],
                    datasets: [{
                        data: [0, 2000],
                        backgroundColor: ['#14b8a6', '#f1f5f9'],
                        borderColor: ['#14b8a6', '#f1f5f9'],
                        borderWidth: 1,
                        cutout: '80%',
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false },
                        tooltip: { enabled: false }
                    }
                }
            });

            function updateDashboard() {
                const hasProfile = userProfile.targetCalories !== null;
                const noProfileWarning = document.getElementById('no-profile-warning');
                const dashboardContent = document.getElementById('dashboard-content');
                
                if (hasProfile) {
                    noProfileWarning.style.display = 'none';
                    dashboardContent.style.display = 'grid';
                    
                    // Update profile display
                    document.getElementById('profile-weight').textContent = `${userProfile.weight} kg`;
                    document.getElementById('profile-height').textContent = `${userProfile.height} cm`;
                    document.getElementById('profile-bmi').textContent = userProfile.bmi.toFixed(1);
                    document.getElementById('profile-target').textContent = `${userProfile.targetCalories} kkal/hari`;
                    document.getElementById('profile-goal').textContent = userProfile.goalText;
                    
                    // Update calorie target
                    caloriesTotalEl.textContent = userProfile.targetCalories;
                    updateCalorieChart();
                } else {
                    noProfileWarning.style.display = 'block';
                    dashboardContent.style.display = 'none';
                }
            }

            function updateCalorieChart() {
                const consumed = foodLog.reduce((sum, food) => sum + food.calories, 0);
                const target = userProfile.targetCalories || 2000;
                const remaining = Math.max(0, target - consumed);
                
                caloriesConsumedEl.textContent = consumed;
                caloriesTotalEl.textContent = target;
                
                calorieChart.data.datasets[0].data[0] = consumed;
                calorieChart.data.datasets[0].data[1] = remaining;
                calorieChart.update();
                
                // Update status
                const statusEl = document.getElementById('calorie-status');
                if (consumed > target) {
                    statusEl.textContent = `Melebihi target sebesar ${consumed - target} kkal`;
                    statusEl.className = 'mt-2 text-sm text-red-600';
                } else if (consumed === target) {
                    statusEl.textContent = 'Target tercapai! üéâ';
                    statusEl.className = 'mt-2 text-sm text-green-600';
                } else {
                    statusEl.textContent = `Sisa ${remaining} kkal lagi`;
                    statusEl.className = 'mt-2 text-sm text-blue-600';
                }
            }

            // Edit profile modal functionality
            const editProfileBtn = document.getElementById('edit-profile-btn');
            const editProfileModal = document.getElementById('edit-profile-modal');
            const closeEditBtn = document.getElementById('close-edit');
            const editProfileForm = document.getElementById('edit-profile-form');

            editProfileBtn.addEventListener('click', () => {
                if (userProfile.targetCalories) {
                    document.getElementById('edit-weight').value = userProfile.weight;
                    document.getElementById('edit-height').value = userProfile.height;
                    document.getElementById('edit-calorie').value = userProfile.targetCalories;
                    document.getElementById('edit-goal').value = userProfile.goal;
                    editProfileModal.classList.remove('hidden');
                }
            });

            closeEditBtn.addEventListener('click', () => {
                editProfileModal.classList.add('hidden');
            });

            editProfileModal.addEventListener('click', (e) => {
                if (e.target === editProfileModal) {
                    editProfileModal.classList.add('hidden');
                }
            });

            editProfileForm.addEventListener('submit', (e) => {
                e.preventDefault();
                
                const weight = parseFloat(document.getElementById('edit-weight').value);
                const height = parseFloat(document.getElementById('edit-height').value);
                const targetCalories = parseInt(document.getElementById('edit-calorie').value);
                const goal = document.getElementById('edit-goal').value;
                
                if (weight > 0 && height > 0 && targetCalories > 0) {
                    // Calculate new BMI
                    const heightInMeters = height / 100;
                    const bmi = weight / (heightInMeters * heightInMeters);
                    
                    // Set goal text
                    let goalText;
                    switch(goal) {
                        case 'lose': goalText = 'Menurunkan berat badan'; break;
                        case 'gain': goalText = 'Menaikkan berat badan'; break;
                        default: goalText = 'Menjaga berat badan';
                    }
                    
                    // Update profile
                    userProfile = {
                        weight,
                        height,
                        bmi,
                        targetCalories,
                        goal,
                        goalText
                    };
                    
                    updateDashboard();
                    editProfileModal.classList.add('hidden');
                    alert('Profil berhasil diperbarui!');
                } else {
                    alert('Mohon isi semua data dengan angka yang valid.');
                }
            });

            // Initialize everything
            initializeFoodDropdown();
            renderFoodLog();
        });
    </script>
</body>
</html>